#создаем виртуальное окружение
python -m venv venv

#активируем виртуальное окружение
venv\scripts\activate

#устанавливаем django в виртуальном окружении
pip install django

#создаем проект
django-admin startproject NewsPortal

#переходим в директорию проекта
cd newsportal

#запустим проект, проверим, что всё работает и создадим пустую базу данных
python manage.py runserver

#создадим новое приложение news
python manage.py startapp news

#открываем файл NewsPortal\settings.py и в список INSTALLED_APPS добавим строчку 'news',

#откроем файл news\models.py и опишем там все модели, их поля и методы

#создадим миграции
python manage.py makemigrations

#применим миграции
python manage.py migrate

#запустим django shell
python manage.py shell



#команды, вводимые в django shell:

#импорт модели User
from django.contrib.auth.models import User

#создание пользователей
user1 = User.objects.create_user('Anton','kulibinav@gmail.com', '4RyvU7kQ') 
user2 = User.objects.create_user('Julia', 'kruglovajm@yandex.ru', '5tHvm1Y9')

#импортируем все модели из нашего приложения
from news.models import *

#создадим авторов
auth1 = Author.objects.create(user=user1)
auth2 = Author.objects.create(user=user2)

#добавим 4 категории
cat1 = Category.objects.create(name='Спорт')
cat2 = Category.objects.create(name='Экономика')
cat3 = Category.objects.create(name='Политика')  
cat4 = Category.objects.create(name='Культура')

#добавим 2 статьи и одну новость
post1 = Post.objects.create(headline='Латыпов выиграл гонку преследования на финальном этапе Кубка России', content='МОСКВА, 18 фев - РИА Новости. Эдуард Латыпов стал победителем гонки преследования на финальном, шестом этапе Кубка России по биатлону, который проходит в Чайковском (Пермский край). Латыпов прошел дистанцию 12,5 км за 31 минуту 43,4 секунды, не допустив ни одного промаха. Вторым стал Карим Халили (отставание 1 минута 1,7 секунды; 1 промах), третьим - Кирилл Бажин (+1.09,3; 0).', author=auth1)

post2 = Post.objects.create(news_type=article, headline='Лунная дорожка: 50 лет музыкальному альбому Dark Side Of The Moon', content='Полвека назад, в начале весны 1973-го, свет увидел альбом Pink Floyd, который по сей день остается не только самой удачной записью группы, но и вообще является одной из лучших фонограмм в истории рока. Речь о феноменальном Dark Side Of The Moon. Спустя 50 лет после релиза популярность пластинки оборотов не сбавляет: количество ежегодно продаваемых в мире экземпляров диска исчисляется десятками тысяч. И есть все основания предполагать, что в этом году продажи "Обратной стороны Луны" выйдут на новый уровень, поскольку по случаю юбилея планируется выход роскошного бокс-сета Dark Side Of The Moon, в который, помимо ремастированной версии оригинального альбома, войдут бонус-диск Live at Wembley Empire Pool и множество других "вкусных" материалов. А фотокнига из бокс-сета будет доступна и отдельно. Так в чем же заключается секрет притягательности данного шедевра? Почему он по прошествии времени не теряет своей актуальности и свежести? Ответ на этот вопрос затрудняются дать даже сами участники Pink Floyd. Так, барабанщик группы Ник Мейсон, отмечал: "Не думаю, чтобы мы это действительно понимали. Есть вещи, которые логическим путем постичь невозможно. Отчасти дело было во времени, когда вышла пластинка, отчасти - в самих песнях, которые оказались созвучны умонастроениям того поколения. Это сделало его популярным и привлекло к нему внимание другого поколения - и так далее". Роджер Уотерс, который доминировал в группе в ту пору (да по большому счету всегда), комментировал феномен пластинки так: "Музыка, что мы создали, была действительно неотразимой, но есть и нечто большее. Возможно, дело в простоте идей, которые привлекательны для любого поколения в момент достижения половой зрелости и осмысления происходящего вокруг". В самом деле, решение Уотерса написать все тексты к Dark Side... придало музыке группы некую сфокусированность. Так, например, атмосферная Breathe повествует о каждодневных стрессах и нагрузках; величественная Time рассказывает о страхе перед взрослением, старением и неизбежной смертью; тревожная и немного "дерганая" Money говорит о беспощадной борьбе за выживание; псевдоубаюкивающая Us And Them призывает задуматься о насилии и борьбе за власть, а одиночество, паранойя и прочие психические расстройства стали лейтмотивом Any Colour You Like, Brain Damage и Eclipse... Эту тему вселенских человеческих переживаний и тревог Роджер Уотерс, опечаленный гибелью своего отца в самом конце Второй мировой, движимый ненавистью к авторитарным лидерам и их бюрократическому аппарату, продолжит развивать и в последующих альбомах Pink Floyd - Wish You Were Here, Animals, The Wall, The Final Cut... Что же касается "Обратной стороны Луны", то запись сего величественного аудиофолианта длилась довольно долго. Но она, как ни странно, не была особенно напряженной. По одной немаловажной причине: перед тем как лечь на пленку, эти треки в большинстве своем уже были "обкатаны" и проверены на публике. В преддверии записи альбома "флойдовцы" успели исполнить новый материал в ходе гастролей по Европе, Америке и Японии. Гитарист и вокалист Дэвид Гилмор вспоминал: "Сегодня, конечно, такой номер уже не прокатил бы. Пираты выпустили бы вперед концертные версии. Но тогда, приходя в студию, все мы уже знали материал. Поэтому исполняли его легко, естественно. Вообще это был чертовски хороший альбом - и музыка, и тексты, и обложка, и концепция".', author=auth2)

post3 = Post.objects.create(news_type=article, headline='Землетрясение как повод для правительства показать свою эффективность', content='Для правительства Р. Эрдогана случившееся бедствие несет в себе как новые возможности, так и риски. У нынешней турецкой администрации есть шанс заявить о себе как об эффективной структуре, способной успешно преодолевать возникшие не по ее вине кризисы и в кратчайшие сроки справляться с последствиями стихийных бедствий. Следует иметь в виду, что природные катастрофы — это тот тип вызова, который для действующей власти несет меньше угроз и дает меньше поводов для критики, чем, например, террористические атаки. Это связано с тем, что такие катаклизмы не могут быть предотвращены и их проявление не зависит от эффективности или же, наоборот, слабости правительства. Появляется повод для сплочения и единения нации вокруг действующих властей в преодолении общей для страны беды. Несмотря на отдельные критические замечания граждан (неизбежные в такой ситуации), на текущий момент спасательные работы, за которые отвечает лично президент, не вызывают каких-либо серьезных нареканий со стороны специалистов, и могут в дальнейшем быть использованы для демонстрации эффективности руководства. В частности, как заявила консалтинговая компания Eurasia Group: "Эрдоган быстро и последовательно отреагировал на кризис. Это, вероятно, укрепит его имидж сильного лидера в преддверии выборов 14 мая при условии, если правительство сможет сохранить свой первоначальный импульс". У турецкого руководства достаточно ресурсов и возможностей, чтобы в сжатые сроки построить новые дома вместо разрушенных и обеспечить всех пострадавших жильем. Хотя это потребует расхода дополнительных бюджетных средств, но позволит отчитаться об успехах в работе по преодолению последствий бедствия. Также в ближайшей перспективе и, что самое важное в преддверие выборов, у администрации Р. Эрдогана есть возможность начать компенсационные выплаты жителям пострадавших районов, включая временных перемещенных лиц (их количество превысило 300 тыс. человек), а также дать им соответствующие гарантии по поводу дальнейшей заботы правительства об их правах, что конечно укрепит базу поддержки нынешнего турецкого лидера. Оппозиция в текущих условиях будет способна лишь выступать с критическими замечаниями в адрес властей. В свою очередь, деятельность правительства по решению проблем, вызванных землетрясением, может отодвинуть на второй план болезненные для граждан вопросы экономического развития страны, связанные с инфляцией, падением курса турецкой лиры, ростом цен и т.д. Таким образом, сохраняющиеся в стране экономические сложности могут быть оправданы необходимостью преодоления последствий землетрясения. В то же время отсутствие новых негативных тенденций в экономике за несколько месяцев до выборов в стране, если конечно правительству удастся это сделать, будет также занесено руководством Турции себе в актив в качестве способности удержать экономическую ситуацию под контролем, несмотря на природное бедствие и связанные с ним убытки и новые расходы на преодоление его последствий. Введение чрезвычайного положения в 10 провинциях страны сроком на три месяца в связи с произошедшей катастрофой может дать в руки Р. Эрдогана еще один козырь для лучшей подготовки к выборам в стране. Режим ЧП как административный ресурс, несомненно, будет использован в интересах действующей власти. Это касается и возможности изменения сроков проведения выборов в том случае, если такая необходимость возникнет. Кроме того, турецкое руководство демонстрирует, что нынешняя катастрофа беспрецедентна не только в масштабах Турции и региона, но и мира в целом. При этом государство успешно справляется с последствиями землетрясения. Р. Эрдоган лично присутствует в координационном штабе, показывая, что все находится под его личным контролем и старательно дает понять, что берет на себя всю ответственность за ситуацию, стремясь решать, а не скрывать проблемы, какими бы ужасными не показались последствия стихии. В этой ситуации для оппозиции было бы политическим самоубийством активизировать свою деятельность по подрыву позиций президента Р. Эрдогана и правящей Партии справедливости и развития (ПСР), начав какую-либо широкую кампанию на фоне природного бедствия. Наоборот, пока политические противники склоны демонстрировать единство перед лицом общей для всей страны трагедии, но это не значит, что уже в ближайшем будущем оппозиция не предпримет шагов с тем, чтобы воспользоваться теми или иными недоработками правительства в преодолении последствий землетрясения.', author=auth2)

#зададим категории для новости и статей
PostCategory.objects.create(post=post1, category=cat1)
PostCategory.objects.create(post=post2, category=cat4)
PostCategory.objects.create(post=post3, category=cat2)
PostCategory.objects.create(post=post3, category=cat3)

#создадим комментарии к новости и публикациям
com1 = Comment.objects.create(text='Тяжелое потрясение, конечно, соболезнования всем пострадавшим!', post=post3, user=user2)
com2 = Comment.objects.create(text='Сколько теперь восстанавливать! Сколько времени и сколько сил!', post=post3, user=user1)
com3 = Comment.objects.create(text='Главное - чтобы люди были живы, а остальное - решаемо...', post=post3, user=user2)
com4 = Comment.objects.create(text='Согласен', post=post3, user=user1)
com5 = Comment.objects.create(text='Здорово! Молодец!', post=post1, user=user2)
com6 = Comment.objects.create(text='Нам бы на Кубок мира вернуться...', post=post1, user=user1)
com7 = Comment.objects.create(text='Легендарная группа! Я в своё время от неё фанател :-)', post=post2, user=user1)

#применим лайки и дизлайки
post1.like()
post2.dislike()
post3.like()

com1.like()
com2.dislike()
com3.like()
com4.like()
com5.like()
com6.like()
com7.dislike()

#обновим рейтинг авторов
auth1.update_rating()
auth2.update_rating()

#Выведем username и рейтинг лучшего пользователя
Author.objects.all().order_by('-author_rating').values('user__username','author_rating').first()

#Выведем дату добавления, username автора, рейтинг, заголовок и превью лучшей статьи
Post.objects.all().order_by('-post_rating').values('datetime_in', 'author__user__username','post_rating', 'headline').first()
Post.objects.all().order_by('-post_rating').first().preview()

#Выведем все комментарии (дата, пользователь, рейтинг, текст) к этой статье.
Comment.objects.filter(post=Post.objects.all().order_by('-post_rating').first()).values('datetime_on', 'user__username', 'comment_rating', 'text')


